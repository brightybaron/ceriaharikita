---
import Card2 from "@components/Card2.astro";
import MainLayout from "@layouts/MainLayout.astro";
import { getCollection } from "astro:content";

const internasionalPackages = await getCollection("paket");

const internasional = internasionalPackages.filter(
  (entry) => entry.data.category === "internasional"
);

const cardData = (entry: any) => ({
  image: entry.data.images[0].url,
  title: entry.data.title,
  slug: entry.id,
  jenistrip: entry.data.jenistrip,
  durasi: entry.data.itineraries.length,
  price: entry.data.price[0],
  category: entry.data.category,
});

let pagetitle = Astro.url.pathname.split("/")[2];

const capitalize = (str: string) => str.charAt(0).toUpperCase() + str.slice(1);
---

<MainLayout title={capitalize(pagetitle === "all" ? "Semua" : pagetitle)}>
  <div class="container mx-auto px-4">
    <h1 class="text-2xl font-bold text-center mb-6">
      Paket {capitalize(pagetitle === "all" ? "Wisata" : pagetitle)}
    </h1>
    <div class="mb-8">
      <ul class="flex space-x-2 text-sm">
        {
          ["all", "promo", "domestik", "internasional"].map((tab) => (
            <li>
              <a
                href={`/paket/${tab}`}
                class:list={[
                  "py-1 px-1.5 rounded-md hover:cursor-pointer ring",
                  tab === pagetitle
                    ? "bg-deep-blue text-white font-semibold"
                    : "bg-white hover:bg-gray-300",
                ]}
              >
                {capitalize(tab)}
              </a>
            </li>
          ))
        }
      </ul>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      {
        internasional.length === 0 ? (
          <div class="col-span-4">
            <p class="text-center">Tidak tersedia paket {pagetitle}</p>
          </div>
        ) : (
          internasional
            .sort((a, b) => a.data.title.localeCompare(b.data.title))
            .map((entry) => <Card2 {...cardData(entry)} />)
        )
      }
    </div>
  </div>
</MainLayout>
